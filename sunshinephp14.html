<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>PHP</title>

		<meta name="description" content="PHP">
		<meta name="author" content="Rasmus Lerdorf">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="/reveal.js/css/reveal.min.css">
		<link rel="stylesheet" href="/samdark.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="/github.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = '/reveal.js/css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>PHP</h1>
					<h3>SunshinePHP</h3>
					<h3>Miami</h3>
					<h3>Feb.7, 2014</h3>
					<a href="http://talks.php.net/show/sunshinephp14">http://talks.php.net/show/sunshinephp14</a><br><br>
					<p>Rasmus Lerdorf<br>
					<small><a href="http://twitter.com/@rasmus">@rasmus</a></small>
					</p>
				</section>
					<section>
		<img src="/presentations/slides/intro/lovehack-white-1000.png" width="1001" height="421">
	</section>
	<section>
		<section id="performance">
		<h2 margin-bottom="2em">PHP 5.5</h2><br>
		<h3 class="p">Performance Improvements</h3>
		<ul>
			<li>Nested calls</li>
			<li>Call stack pre-allocated by compiler</li>
			<li>Bundled opcode cache</li>
		</ul>
		</section>
<section id="generators">
		<h4 class="p">✔ Generators</h4>
		<pre><code data-trim class="php">
function xrange($start, $end) {
    for ($i = $start; $i <= $end; $i ++) {
        yield $i;
    }
}
foreach (xrange(0, 5) as $i) {
    echo $i, "\n";
}</code></pre>
		</section>
<section id="finally">
		<h4 class="p">✔ finally</h4>
		<pre><code data-trim class="php">
$db = mysqli_connect();
try {
   call_some_function($db);
} finally {
   mysqli_close($db);
}</code></pre>
		</section>
<section id="foreachlist">
		<h4 class="p">✔ list() in foreach</h4>
		<pre><code data-trim class="php">
$names = [ ['John','Smith'], ['Fred','Johnson'] ];
foreach($names as list($first,$last)) { 
    echo $first,$last; 
}</code></pre>
		</section>
<section id="constarray">
		<h4 class="p">✔ Const array/string Dereferencing</h4>
		<pre><code data-trim class="php">
echo array(1, 2, 3)[0]; //output 1
echo "foobar"[3]; //output b
echo [1,3,4][2]; //output 4</code></pre>
		</section>
<section id="others">
		<h4 class="p">✔ empty() support for functions/expressions</h4>
		<h4 class="p">✔ curl upload functionality rewritten</h4>
		<h4 class="p">✔ Simplified password hashing API</h4>
		<pre><code data-trim class="php">
// Hash
$hash = password_hash("super secret",PASSWORD_BCRYPT);

// To validate $pwd against the stored hash
if (password_verify($pwd, $hash)) {
    echo 'Password is valid!';
} else {
    echo 'Invalid password.';
}
</code></pre>
		</section>	</section>
	<section>
		<section id="php56">
		<h2 margin-bottom="2em">PHP 5.6</h2><br>
		<h4 class="p">✔ Variadic functions</h4>
		<pre><code data-trim class="php">
class MySQL implements DB {
    public function query($query, ...$params) {
        $stmt = $this->pdo->prepare($query);
        $stmt->execute($params);
        return $stmt;
    }
}

$q = 'SELECT * FROM users WHERE id = ?';
$user = $db->query($q, $userID)->fetch();</code></pre>
		</section>
<section id="php56unpack">
		<h4 class="p">✔ Argument Unpacking</h4>
		<pre><code data-trim class="php">
// A better call_user_func_args
$args1 = [1, 2, 3];
$args2 = [4, 5, 6];
test(...$args1, ...$args2); // [1, 2, 3, 4, 5, 6]
test(1, 2, 3, ...$args2);   // [1, 2, 3, 4, 5, 6]
test(...$args1, 4, 5, 6);   // [1, 2, 3, 4, 5, 6]</code></pre>
		<h4 class="p">✔ Constant scalar expressions</h4>
		<pre><code data-trim class="php">
class Foo {
    const FOO = 1 + 1;
    const BAR = 1 << 1;
    const GREETING = "HELLO";
    const BAZ = self::GREETING." WORLD!"
}</code></pre>
		</section>
<section id="php56pow">
		<h4 class="p">✔ Add right-associative power operator **</h4>
		<pre><code data-trim class="php">
echo 2 ** 3 ** 2; // 512 (not 64)
echo -3 ** 2; // -9 (not 9)
echo 1 - 3 ** 2; // -8
echo ~3 ** 2; // -10 (not 16)</code></pre>
		<h4 class="p">✔ Internal operator overloading for internal features like GMP</h4>
		<pre><code data-trim class="php">
echo 2**512;
echo "\n";
$n = gmp_init(2);
echo $n**512;
</code></pre>
		<pre><code data-trim class="php">1.3407807929943E+154
13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084096
		</code></pre>		</section>
<section id="php56use">
		<h4 class="p">✔ use function and use const namespace imports</h4>
		<pre><code data-trim class="php">
include 'template.inc';
include 'db.inc';
use function template\header, template\footer, db\query;

header('My Page');
query('select * from stuff');
footer(); </code></pre>
		<h4 class="p">✔ SSL Peer verification by default</h4>
		<h4 class="p">✔ New phpdbg SAPI</h4>
		<h4 class="p">✔ Support for > 2GB file uploads</h4>
		<h4 class="p">✔ OCI8 Improvements</h4>
		</section>	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<h3 class="p">Are your deploys atomic?</h3>
		<h3 class="p">Are you sure?</h3>
		<h4 class="p">What happens to a request that is currently executing when you deploy?</h4>
	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<img src="/presentations/slides/intro/dep1.png" width="642" height="300">
	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<h4 class="p">✔ Don't copy files into current document root</h4>
		<h4 class="p">✔ Let existing requests finish on old code</h4>
		<h4 class="p">✔ New requests start on new code</h4>
		<h4 class="p">✔ Avoid clearing your opcode cache</h4>
		<h4 class="p">✔ Minimal impact on production traffic</h4>
	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<img src="/presentations/slides/intro/dep2.png" width="680" height="428">
	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<img src="/presentations/slides/intro/dep3.png" width="680" height="428">
	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<h4 class="p">2 Document Root directories</h4>
		<h4 class="p">Symlink /var/www/site toggles between them</h4>
		<h4 class="p">realpath() symlink at the web server level</h4>
		<h4 class="p">Set Document Root to symlink realpath</h4>
		<h4 class="p">Never hardcode the document root in code</h4>
	</section>
	<section>
		<h2 margin-bottom="2em">Deploying Web Apps</h2><br>
		<h3 class="p">Apache</h3>
		<h4 class="p">http://github.com/etsy/mod_realdoc</h4>
		<h3 class="p">nginx</h3>
		<h4 class="p">You can use $realpath_root</h4>
		<p class="p">eg. fastcgi_param DOCUMENT_ROOT $realpath_root;</p>
		<h3 class="p">PHP</h3>
		<h4 class="p">http://github.com/etsy/incpath</h4>
	</section>
	<section>
		<img src="/presentations/slides/intro/lovehack-white-1000.png" width="1001" height="421">
	</section>
	<section data-background="#000000">
		<img src="/presentations/slides/intro/rasmus.jpg" width="523" height="700">
	</section>
	<section data-background="#000000">
		<img src="/presentations/slides/intro/Greenland1.jpg" width="1024" height="685">
	</section>
	<section data-background="#000000">
		<img src="/presentations/slides/intro/Greenland2.jpg" width="1024" height="685">
	</section>
	<section data-background="#000000">
		<img src="/presentations/slides/intro/Greenland3.jpg" width="1024" height="685">
	</section>
	<section>
		<h2>Work on things that matter</h2>
	</section>
	<section>
		<h4 class="p">We are running out of things that can be solved in isolation with our keyboards</h4>
	</section>
	<section>
		<img src="/presentations/slides/intro/barros1.png" width="480" height="320">
		<img src="/presentations/slides/intro/barros2.jpg" width="250" height="196">
		<img src="/presentations/slides/intro/barros3.jpg" width="250" height="367">
		<img src="/presentations/slides/intro/sasa.jpg" width="600" height="400">
	</section>
			</div>

		</div>

		<script src="/reveal.js/lib/js/head.min.js"></script>
		<script src="/reveal.js/js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				backgroundTransition: 'none',

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '/reveal.js/plugin/zoom-js/zoom.js', async: true, callback: function() { return !!document.body.classList; } },
					{ src: '/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
